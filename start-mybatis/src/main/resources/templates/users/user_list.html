<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" th:href="@{'/static/staticres/layui/css/layui.css'}"  media="all">
<title>用户列表</title>
</head>
<body>
	
	<table id="dates" lay-filter="test"></table>
 	<button type="button" class="layui-btn layui-btn-normal" onclick="addUser()">添加用户</button>
<script th:src="@{'/static/staticres/layui/layui.js'}"></script>
<script th:src="@{'/static/staticres/test/jquery.js'}"></script>

<!--引入弹窗组件start-->
<script th:src="@{'/static/staticres/plugins/attention/zDialog/zDrag.js'}"></script>
<script th:src="@{'/static/staticres/plugins/attention/zDialog/zDialog.js'}"></script>
<script type="text/javascript">
layui.use('table', function(){
    var table = layui.table;
                table.render({
            elem: '#dates'
            ,url:'/user/selectUserTable'
            ,limit:5 //默认为10
            ,cols: [
            	
            	[
                {field:'id', width:170, title: '用户ID', sort: true} //sort：true页面可进行排序操作
                ,{field:'name', width:400, title: '姓名'}
                ,{field:'level',width:500, height:50, title: '操作',templet: function(d){
                    //return'<a id="delete" class="layui-btn layui-btn-xs layui-btn-danger" onclick="deleteFile('+d.id+');">删除</a> ';
                    return '<div class="layui-btn-group"><button type="button" class="layui-btn layui-btn-sm"><i class="layui-icon" onclick="updateUser('+d.id+');"></i></button><button type="button" class="layui-btn layui-btn-sm"><i class="layui-icon" onclick="deleteUser('+d.id+');"></i></button></div>'
                   }
                }
            	]
            	
            		]
            ,page: true
            ,limits:[5,10,15,20]
            ,done:function(res, curr, count){
                //数据的回调用，可不写
            }
        });
    });
    
//添加用户    
function addUser(){
	var dialog = new Dialog();
	dialog.Width="50%";
	dialog.Height="80%";
	dialog.Title="添加用户";
	dialog.URL="addUser";
	dialog.OKEvent=function(){
		window.top.userConfig();
	}
	dialog.CancelEvent = function(){//关闭事件
		dialog.close();
	}
	dialog.show();
	
}
//更改用户
function updateUser(id){
	var dialog = new Dialog();
	dialog.Width="50%";
	dialog.Height="80%";
	dialog.Title="更改用户";
	dialog.URL="updateUser?id="+id;
	dialog.OKEvent=function(){
		window.top.userConfig();
	}
	dialog.CancelEvent = function(){//关闭事件
		dialog.close();
	}
	dialog.show();
}
//删除用户
function deleteUser(id){
	$.ajax({
		type:"GET",
		url:"deleteUser?id="+id,
		type:"json",
		success: function(data){
			if(data.msg == 'success'){
				window.top.userConfig();
			}
		}
	});
}
</script>
</body>
</html>