<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8">
  <title>Layui</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" th:href="@{'/static/staticres/layui/css/layui.css'}"  media="all">
</head>
<body>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>用户文件表格</legend>
</fieldset>
 
<div class="layui-form">
  <table class="layui-table">
    <colgroup>
      <col width="150">
      <col width="150">
      <col width="200">
      <col>
    </colgroup>
    <thead>
      <tr>
        <th>序号</th>
        <th>文件名称</th>
        <th>文件大小</th>
        <th>操作</th>
      </tr> 
    </thead>
    <tbody>
      <tr th:if="${varList != null}" th:each="var,varStat:${varList}" >
        <td th:text="${varStat.index}+1"></td>
        <td th:text="${var.filName}"></td>
        <td th:text="${var.fileSize}"></td>
        <td>
        <button type="button" class="layui-btn layui-btn-sm" th:onclick="'javascript:deleteFile('+${var.id}+')'"><i class="layui-icon"></i></button>
        <button type="button" class="layui-btn layui-btn-warm layui-btn-radius" th:onclick="'javascript:preOpen('+${var.id}+')'">查看图片</button>
        </td>
      </tr>
      <tr th:if="${varList == null}">
       
      </tr>
    </tbody>
  </table>
  <div id="demo7"></div>
</div>
 <button type="button" class="layui-btn layui-btn-normal" onclick="addFile()">添加文件</button>
<script th:src="@{'/static/staticres/layui/layui.js'}"></script>
<script th:src="@{'/static/staticres/test/jquery.js'}"></script>

<!--引入弹窗组件start-->
<script th:src="@{'/static/staticres/plugins/attention/zDialog/zDrag.js'}"></script>
<script th:src="@{'/static/staticres/plugins/attention/zDialog/zDialog.js'}"></script>
<script type="text/javascript">

layui.use(['laypage', 'layer'], function(){
	  var laypage = layui.laypage
	  ,layer = layui.layer;
	  //完整功能
	  laypage.render({
	    elem: 'demo7'
	    ,count: 100
	    ,layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
	    ,jump: function(obj){
	      console.log(obj)
	    }
	  });  
});

//添加文件
function addFile(){
	var dialog = new Dialog();
	dialog.Width="50%";
	dialog.Height="80%";
	dialog.Title="添加文件";
	dialog.URL="addFile";
	dialog.OKEvent=function(){
		window.top.userFileConfig();
	}
	dialog.CancelEvent = function(){//关闭事件
		dialog.close();
	}
	dialog.show();
}
//删除文件
function deleteFile(id){
	Dialog.confirm("确认删除吗？",function(){
		$.ajax({
			type:"GET",
			url:"deleteFile?id="+id,
			contentType: "application/json;charset=utf-8",
			success: function(data){
				if(data.msg == "success"){
					window.top.userFileConfig();
				}else{
					Dialog.confirm("删除失败");
				}
			}
		});
	});
}
//预览图片
function preOpen(id){
	var dialog = new Dialog();
	dialog.Width="50%";
	dialog.Height="80%";
	dialog.Title="预览文件";
	dialog.URL="openFile?id="+id;
	dialog.OKEvent=function(){
		window.top.userFileConfig();
	}
	dialog.CancelEvent = function(){//关闭事件
		dialog.close();
	}
	dialog.show();
}
</script>
</body>
</html>