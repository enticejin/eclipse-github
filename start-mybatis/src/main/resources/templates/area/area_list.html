<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" th:href="@{'/static/staticres/test/jquery-ui.css'}" />
<link rel="stylesheet" th:href="@{'/static/staticres/test/test.css'}" />
<link rel="stylesheet" th:href="@{'/static/staticres/layui/css/layui.css'}"  media="all">
<!-- Bootstrap 3.3.6 -->
<link rel="stylesheet" th:href="@{'/static/staticres/bootstrap/css/bootstrap.css'}">
<title></title>
<meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>
<body>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>区域表格</legend>
</fieldset>
		<div>
	<form action="areaList" method="post" name="Form" id="Form">
			<div class="layui-inline">
				<table>
					<tr>
						<td><input class="layui-input"  id="nav-search-input" type="text" name="NAME" value="" placeholder="区域名称" /></td>
						<td> <button type="button" onclick="query();" class="layui-btn layui-btn-radius">搜索</button></td>
					</tr>
				</table>
			</div>
			</form>
		</div>
			<!--		
<div class="container-fluid" style="padding:10px 23px 10px 23px;">
		
		<form action="areaList" method="post" name="Form" id="Form">
			<div class="row table-query">
				<table>
					<tr>
						<td><input class="form-control input-sm"  id="nav-search-input" type="text" name="NAME" value="" placeholder="区域名称" /></td>
						<td><a class="btn btn-block btn-default btn-sm btn-flat" onclick="query();" title="检索"><i class="fa fa-search" style="color: #3C8DBC;"></i></a></td>
					</tr>
				</table>
			</div>
			</form>
			
			
		<div class="row" >
				<table id="table_report" class="table table-striped table-condensed table-bordered table-hover" style="margin:5px 0px 0px 2px;">
					<thead>
						<tr>
							<th><input  type="checkbox" id="zcheckbox" /></th>
							<th>区域名称</th>
							<th>时钟源</th>
							<th>定位维度</th>
							<th>备注</th>
							<th>区域状态</th>
							<th style="text-align: center; width:200px;">操作</th>
						</tr>
					</thead>
					<tbody th:if="${flag == 'area'}">
								<tr th:each="area:${areaList}">
											<td><input type='checkbox' name='ids' th:value="${area.id}"></td>
											<td th:text="${area.areaName}"></td>
											<td th:text="${area.clockName}"></td>
											<td th:id="${area.id}" th:if="${area.areaWide} == 1" th:text="一维"></td>
											<td th:id="${area.id}" th:if="${area.areaWide} == 2" th:text="二维"></td>
											<td th:id="${area.id}" th:if="${area.areaWide} == 3" th:text="三维"></td>
											<td th:text="${area.remarks}"></td>
											<td th:if="${area.action} == 'true'">
												<span>在线</span>
											</td>
											<td th:if="${area.action} != 'true'">
												<span>离线</span>
											</td>
											
											
									<td style="width: 180px;text-align: center;">
										<button type="button" class="btn bg-purple btn-xs btn-flat" th:onclick="'javascript:gotoAreaEditOnMap('+${area.id}+')'">编辑形状</button>
									
										 <button type="button" class="btn bg-purple btn-xs btn-flat" th:onclick="'javascript:copy('+${area.id}+')'">复制区域</button>
										<a title="修改"  class="btn btn-social-icon  btn-primary btn-xs btn-flat" th:onclick="'javascript:edit('+${area.id}+')'"><i class="fa fa-edit"></i></a>
										
										<a class="btn btn-social-icon btn-danger btn-xs btn-flat" title="删除" th:onclick="'javascript:del('+${area.id}+')'"><i class="fa fa-trash"></i></a>
									</td>
								</tr>
						</tbody>
				</table>
				<a class="btn btn-small btn-success btn-sm btn-flat" onclick="add();">新增</a>
		</div>
		 <form id="pageForm" >
		<input type="hidden" id="pages" name="pages">
		<div>
			<nav align="right" aria-label="Page navigation">
			  <ul class="pagination">
			    <li>
			      <a href="#" th:onclick="javascript:jumpPage(1)" aria-label="首页">
			        <span aria-hidden="true">&laquo;</span>
			      </a>
			    </li>
			    <li><a href="#" onclick="jumpPre()">上一页</a></li>
			     <li><a href="#" th:text="${pages}"></a></li>
			    <li><a href="#" onclick="jumpNext()">下一页</a></li>
			    <li>
			      <a href="#" id="end" onclick="jumpEnd()" aria-label="尾页">
			        <span aria-hidden="true" placeholder="尾页" >&raquo;</span>
			      </a>
			    </li>
			  </ul>
			</nav>
		</div>
	</form>
	</div>
	<div>
		<input type="hidden" th:value="${rtle.logitude}" th:name="longitude" th:id="longitude" maxlength="32">
		<input type="hidden" th:value="${rtle.latitude}" th:name="latitude" th:id="latitude" maxlength="32">
	</div>
			-->
	<div>
		<input type="hidden" th:value="${rtle.logitude}" th:name="longitude" th:id="longitude" maxlength="32">
		<input type="hidden" th:value="${rtle.latitude}" th:name="latitude" th:id="latitude" maxlength="32">
	</div>		
	<table id="dates" lay-filter="test"></table>
<button type="button" class="layui-btn layui-btn-normal" onclick="add()">添加区域</button>
<script th:src="@{'/static/staticres/test/jquery.js'}"></script>
<script th:src="@{'/static/staticres/layui/layui.js'}"></script>
<!--引入弹窗组件start-->
<script th:src="@{'/static/staticres/plugins/attention/zDialog/zDrag.js'}"></script>
<script th:src="@{'/static/staticres/plugins/attention/zDialog/zDialog.js'}"></script>
<script th:src="@{'/static/staticres/bootstrap/js/bootstrap.js'}"></script>
<script type="text/javascript">
layui.use('table', function(){
    var table = layui.table;
    	table.render({
            elem: '#dates'
            ,url:'/area/selectAreaTable'
            ,limit:5 //默认为10
            ,cols: [
            	
            	[
                {field:'areaName', width:170, title: '区域名称', sort: true} //sort：true页面可进行排序操作
                ,{field:'areaWide', width:400, title: '区域维度'}
                ,{field:'clockName',width:170,  title: '时钟源'}
                ,{field:'action',width:170,  title: '是否激活'}
                ,{field:'remarks',width:170,  title: '备注'}
                ,{field:'level',width:500, height:50, title: '操作',templet: function(d){
                    //return'<a id="delete" class="layui-btn layui-btn-xs layui-btn-danger" onclick="deleteFile('+d.id+');">删除</a> ';
                    return '<button type="button" onclick="gotoAreaEditOnMap('+d.id+');" class="layui-btn layui-btn-normal">配置地图</button><button type="button" class="layui-btn layui-btn-normal layui-btn-sm"><i class="layui-icon" onclick="copy('+d.id+');"></i></button><div class="layui-btn-group"><button type="button" class="layui-btn layui-btn-sm"><i class="layui-icon" onclick="edit('+d.id+');"></i></button><button type="button" class="layui-btn layui-btn-sm"><i class="layui-icon" onclick="del('+d.id+');"></i></button></div>'
                   }
                }
            	]
            	
            		]
            ,page: true
            ,limits:[5,10,15,20]
            ,done:function(res, curr, count){
                //数据的回调用，可不写
                //区域纬度
            	$("[data-field='areaWide']").each(function(){
            	   　　if($(this).text()=='1'){
            	      　　$(this).text("一维")
            	      　　$(this).width("56px")
            	      }else if($(this).text()=='2'){
            	         $(this).text("二维")
            	      }else if($(this).text()=='3')
            	    	  $(this).text("三维") 
            	    	else{
            	    		 $(this).text("区域维度")
            	    	}
            	   });
                //是否激活
            	$("[data-field='action']").each(function(){
           	   　　if($(this).text()=='true'){
           	      　　$(this).text("是")
           	      　　$(this).width("56px")
           	      }else if($(this).text()=='false'){
           	         $(this).text("否")
           	      }
           	    	else{
           	    		 $(this).text("是否激活")
           	    	}
           	   });
            }
        });        
    });
//查询
function query(){
	var areaName = $("#nav-search-input").val();
	if(areaName == null || areaName.trim().length == 0){
		Dialog.alert("输入信息有误");
	}else{
		$.ajax({
			type:"GET",
			url:"select?areaName="+areaName,
			success:function(data){
				if(data.msg == "success"){
					window.location.href="areaList?ids="+data.ids;
				}else if(data.msg== "fail"){
					Dialog.alert("没有找到对应的区域");
				}
			}
		});
	}
}
//删除区域
function del(id){
	var d = {};
	d.id = id;
	Dialog.confirm("确认删除此区域吗？",function(){
		$.ajax({
			type:"GET",
			url:"delete?id="+id,
			contentType: "application/json;charset=utf-8",
			success: function(data){
				if(data.msg == "success"){
					window.location.href="areaList";
				}else{
					Dialog.confirm("删除区域失败");
				}
			}
		});
	});
	
}
var addDiag;
//复制区域
function copy(id){
	 addDiag = new Dialog();
	addDiag.Width = 770;
	addDiag.Height = 420;
	addDiag.Title = "复制区域";
	addDiag.URL = "copy?id="+id;
	addDiag.OKEvent = function(){
		addDiag.innerFrame.contentWindow.save();
	}
	addDiag.CancelEvent = function(){//关闭事件
		if(addDiag.innerFrame.contentWindow.document.getElementById('zhongxin').style.display == 'none'){
			location.reload();
		}
		addDiag.close();
	}
	addDiag.show(); 
}
//编辑形状
function gotoAreaEditOnMap(id){
	window.parent.addEditMap('area/mapLngLat?longitude='+$("#longitude").val()+'&latitude='+$("#latitude").val()+'&id='+id);
}	
/*
//跳转页面
function jumpPage(pages) {
			var url = '[[${url}]]';
			url = url.split("/")[1];
			$("#pages").val(pages);
			$("#pageForm").attr({"method":"post","action":url});
			$("#pageForm").submit();
		}
//上一页
function jumpPre(){
	var pages = [[${pages}]] - 1;
	if(pages < 1){
		pages = 1;
	}
	jumpPage(pages);
}
//下一页
function jumpNext(){
	var pages = [[${pages}]] + 1;
	var sumPage = [[${sumPage}]]
	if(pages > sumPage){
		pages = sumPage
	}
	jumpPage(pages)
}
//尾页
function jumpEnd(){
	var sumPage = [[${sumPage}]]	
	jumpPage(sumPage)
}
*/
//添加区域配置
function add(){
	addDiag = new Dialog();
	addDiag.Width = 770;
	addDiag.Height = 420;
	addDiag.Title = "新增";
	addDiag.URL = "areaAdd";
	addDiag.OKEvent = function(){
		addDiag.innerFrame.contentWindow.save();
	}
	addDiag.CancelEvent = function(){//关闭事件
		if(addDiag.innerFrame.contentWindow.document.getElementById('zhongxin').style.display == 'none'){
			location.reload();
		}
		addDiag.close();
	}
	addDiag.show(); 
}
//修改区域配置
function edit(id){
	addDiag = new Dialog();
	addDiag.Width = 770;
	addDiag.Height = 420;
	addDiag.Title = "修改区域";
	addDiag.URL = "areaAdd?id="+id;
	addDiag.OKEvent = function(){
		addDiag.innerFrame.contentWindow.save();
	}
	addDiag.CancelEvent = function(){//关闭事件
		if(addDiag.innerFrame.contentWindow.document.getElementById('zhongxin').style.display == 'none'){
			location.reload();
		}
		addDiag.close();
	}
	addDiag.show(); 
}
</script>
</body>
</html>